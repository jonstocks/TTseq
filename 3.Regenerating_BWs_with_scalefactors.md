# Remake BWs with scale factors

Use scale factors generated with DESeq2 to remake BWs

Scale factors are opposite for deseq/ (multiplied rather than divided or other way around) so need divide 1 by scale factor 1st

e.g 1.5472687 -> 0.6463001545885

```bash
#!/bin/bash -f
#$ -S /bin/bash
#$ -cwd
#$ -l h_vmem=128g
#$ -l h_rt=24:00:00
#
. /etc/profile.d/modules.sh
MODULEPATH=$MODULEPATH:/exports/igmm/software/etc/el7/modules

module load igmm/apps/samtools/1.6
module load igmm/apps/BEDTools/2.25.0
module load igmm/libs/libpng/1.6.18
module load igmm/apps/ucsc/v326
module load igmm/apps/python/3.5.2

echo $1 $2

bamCoverage -bl ~/blacklist/hg38-blacklist.v2.bed -p 4 --binSize 20 --scaleFactor=$2 -b $1.sorted.bam -o $1.$2.scaled.20.bw
```

```bash
qsub ~Jon/scripts/coverage_scale.sh <sample_name> <scalefactor>
qsub ~Jon/scripts/coverage_scale.sh Ctrl_NHS_A 0.6463001545885
```

Then upload and view BWs on UCSC as before


### Stranded BWs

coverage_scale_strand.sh

```bash
#!/bin/bash -f
#$ -S /bin/bash
#$ -cwd
#$ -l h_vmem=48g
#$ -l h_rt=24:00:00
#
. /etc/profile.d/modules.sh
MODULEPATH=$MODULEPATH:/exports/igmm/software/etc/el7/modules

module load igmm/apps/bowtie/2.2.6
module load igmm/apps/samtools/1.6
module load igmm/apps/BEDTools/2.25.0
module load igmm/libs/libpng/1.6.18
module load igmm/apps/ucsc/v326
module load igmm/apps/python/3.5.2

echo $1 $2

bamCoverage -bl hg38-blacklist.v2.bed -p 4 --filterRNAstrand forward --binSize 20 --scaleFactor=$2 -b $1.sorted.bam -o $1.20.fwd.bw
bamCoverage -bl hg38-blacklist.v2.bed -p 4 --filterRNAstrand reverse --binSize 20 --scaleFactor=$2 -b $1.sorted.bam -o $1.20.rv.bw
```


